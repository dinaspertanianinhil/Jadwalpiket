<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Piket 2026</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdDTXGJIkjphkmC30hMYVpmbZwDdy1XzTH3jFDe16W10jQRXa5mLkwfmLq&s=10') no-repeat center center fixed;
    background-size:cover;
}

.overlay{
    background:rgba(0,0,0,0.6);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.card{
    background:white;
    width:100%;
    max-width:550px;
    border-radius:20px;
    padding:30px;
    box-shadow:0 25px 50px rgba(0,0,0,0.4);
    text-align:center;
}

.header{
    margin-bottom:20px;
}

.header h2{
    margin:0;
    font-size:18px;
    font-weight:700;
}

.header p{
    margin:5px 0 0 0;
    font-size:13px;
    color:#555;
}

.tanggal{
    font-weight:600;
    margin:15px 0;
}

ul{
    list-style:none;
    padding:0;
}

li{
    padding:10px;
    margin:6px 0;
    background:#f1f3f5;
    border-radius:10px;
    font-weight:500;
}

button{
    margin-top:15px;
    padding:10px 18px;
    border:none;
    border-radius:10px;
    background:#2e7d32;
    color:white;
    font-weight:600;
    cursor:pointer;
}

button:hover{
    background:#1b5e20;
}
</style>
</head>
<body>

<div class="overlay">
<div class="card">

<div class="header">
    <h2>DINAS PERTANIAN</h2>
    <p>Kabupaten Indragiri Hilir</p>
</div>

<h3>JADWAL PIKET HARI INI</h3>

<div class="tanggal" id="tanggal"></div>

<ul id="petugas"></ul>

<button onclick="downloadExcel()">Download Rekap Bulan Ini</button>

</div>
</div>

<script>

const pegawai = [
"Heri Yanto","Andika Subeky","Juhaiman","Abd. Hamid","Taufik",
"Dwi Apriyanto","Khaidir Saputra","Ari Wibowo","Adi Khairul Anam","Eko Priyono",
"Arif Rahman","Muhammad Rizky","Andi Suardi","Berry Tri Yoka","Hendriansah",
"Edi Santoso","Rano","Asliansyah","Burhanuddin","Heri Firman",
"Deventer Putra P","Zikrullah","Dedy Suryandana","Decky Zulkamain","Iwan Radiardi",
"Cecep Setiawan","M. Nur Oktaris","Rudi Guntara","Dico Maicandra","Kadris",
"Endrio Naldo","Fiki Boys","Reinaldy Alvino","Edi Wibowo","Kaspul Khair",
"Frenly Wirnawan","Bagus Pratama P","M. Aditia Yulianto","Murdiono",
"Putra Andini","Safruddin","Jamaluddinsyah","Hasanudin","Reza Fahlevi A",
"Anugerah Dwi P","Sunhil Mahendra","Maulana Rahman","M. Juraji","Sugeng Pranoto",
"Feri Ibrahim","Agus Riyanto","Subarjo","Marzuki","Syahrudin",
"Muhammad Rafai","Dahri Ansori","Abdu Samad","Oktarian Priyatno",
"Andriansyah","Randi Febriadi","Sarno Budi Santoso","Sigit Santoso"
];

let schedule = [];
let indexPegawai = 0;

function generateSchedule(){
    const start = new Date("2026-01-01");
    const end = new Date("2026-12-31");

    for(let d = new Date(start); d <= end; d.setDate(d.getDate()+1)){
        const day = d.getDay();
        if(day === 0 || day === 6) continue;

        const tanggal = d.toISOString().split("T")[0];
        const hariNama = d.toLocaleDateString("id-ID",{weekday:"long"});

        let petugas = [];
        for(let i=0;i<5;i++){
            petugas.push(pegawai[indexPegawai % pegawai.length]);
            indexPegawai++;
        }

        schedule.push({tanggal,hariNama,petugas});
    }
}

generateSchedule();

const today = new Date().toISOString().split("T")[0];
const dataHariIni = schedule.find(s => s.tanggal === today);

document.getElementById("tanggal").textContent =
new Date().toLocaleDateString("id-ID",{weekday:"long", year:"numeric", month:"long", day:"numeric"});

const list = document.getElementById("petugas");

if(dataHariIni){
    dataHariIni.petugas.forEach(nama=>{
        const li = document.createElement("li");
        li.textContent = nama;
        list.appendChild(li);
    });
}else{
    list.innerHTML = "<li>Tidak ada jadwal hari ini</li>";
}

function downloadExcel(){

    const now = new Date();
    const bulan = now.getMonth();
    const tahun = now.getFullYear();

    const dataBulanIni = schedule.filter(s=>{
        const d = new Date(s.tanggal);
        return d.getMonth() === bulan && d.getFullYear() === tahun;
    });

    const namaBulan = now.toLocaleDateString("id-ID",{month:"long"});

    const header = [["Tanggal","Hari","Petugas 1","Petugas 2","Petugas 3","Petugas 4","Petugas 5"]];
    
    const data = dataBulanIni.map(s=>[
        s.tanggal,
        s.hariNama,
        s.petugas[0],
        s.petugas[1],
        s.petugas[2],
        s.petugas[3],
        s.petugas[4]
    ]);

    const ws = XLSX.utils.aoa_to_sheet(header.concat(data));
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Jadwal");

    XLSX.writeFile(wb, `Rekap_Piket_${namaBulan}_${tahun}.xlsx`);
}

</script>
</body>
</html>
