<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Piket 2026</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body{
    margin:0;
    font-family:'Poppins', 'Segoe UI', sans-serif;
    background:url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdDTXGJIkjphkmC30hMYVpmbZwDdy1XzTH3jFDe16W10jQRXa5mLkwfmLq&s=10') no-repeat center center fixed;
    background-size:cover;
    color:white;
}

/* overlay gelap elegan */
.overlay{
    background:linear-gradient(135deg, rgba(0,0,0,0.75), rgba(0,40,0,0.75));
    min-height:100vh;
    padding:60px 20px;
    display:flex;
    flex-direction:column;
    align-items:center;
}

/* HEADER DINAS */
.header-dinas{
    text-align:center;
    margin-bottom:40px;
}

.header-dinas h1{
    margin:0;
    font-size:26px;
    letter-spacing:3px;
    font-weight:700;
}

.header-dinas p{
    margin-top:8px;
    font-size:14px;
    letter-spacing:2px;
    opacity:0.9;
}

/* GLASS CARD */
.card{
    width:100%;
    max-width:520px;
    padding:35px;
    border-radius:25px;
    backdrop-filter:blur(18px);
    background:rgba(255,255,255,0.12);
    border:1px solid rgba(255,255,255,0.25);
    box-shadow:0 25px 60px rgba(0,0,0,0.6);
    text-align:center;
}

/* Title dalam card */
.card h3{
    margin:0 0 15px 0;
    font-size:18px;
    letter-spacing:2px;
    font-weight:600;
}

/* tanggal */
.tanggal{
    margin-bottom:20px;
    font-size:14px;
    opacity:0.9;
}

/* list nama */
ul{
    list-style:none;
    padding:0;
    margin:0 0 25px 0;
}

li{
    padding:12px;
    margin:8px 0;
    border-radius:14px;
    background:rgba(255,255,255,0.15);
    backdrop-filter:blur(8px);
    font-weight:500;
    transition:0.3s;
}

li:hover{
    background:rgba(255,255,255,0.25);
    transform:scale(1.02);
}

/* button modern */
button{
    padding:12px 24px;
    border:none;
    border-radius:30px;
    background:linear-gradient(90deg,#4caf50,#2e7d32);
    color:white;
    font-weight:600;
    cursor:pointer;
    letter-spacing:1px;
    transition:0.3s;
}

button:hover{
    transform:translateY(-2px);
    box-shadow:0 10px 25px rgba(0,0,0,0.5);
}
</style>
</head>
<body>

<div class="overlay">

    <div class="header-dinas">
        <h1>DINAS PERTANIAN</h1>
        <p>KABUPATEN INDRAGIRI HILIR</p>
    </div>

    <div class="card">
        <h3>JADWAL PIKET HARI INI</h3>
        <div class="tanggal" id="tanggal"></div>
        <ul id="petugas"></ul>
        <button onclick="downloadExcel()">Download Rekap Bulan Ini</button>
    </div>

</div>

<script>
const pegawai = [
"Heri Yanto","Andika Subeky","Juhaiman","Abd. Hamid","Taufik",
"Dwi Apriyanto","Khaidir Saputra","Ari Wibowo","Adi Khairul Anam","Eko Priyono",
"Arif Rahman","Muhammad Rizky","Andi Suardi","Berry Tri Yoka","Hendriansah",
"Edi Santoso","Rano","Asliansyah","Burhanuddin","Heri Firman",
"Deventer Putra P","Zikrullah","Dedy Suryandana","Decky Zulkamain","Iwan Radiardi",
"Cecep Setiawan","M. Nur Oktaris","Rudi Guntara","Dico Maicandra","Kadris",
"Endrio Naldo","Fiki Boys","Reinaldy Alvino","Edi Wibowo","Kaspul Khair",
"Frenly Wirnawan","Bagus Pratama P","M. Aditia Yulianto","Murdiono",
"Putra Andini","Safruddin","Jamaluddinsyah","Hasanudin","Reza Fahlevi A",
"Anugerah Dwi P","Sunhil Mahendra","Maulana Rahman","M. Juraji","Sugeng Pranoto",
"Feri Ibrahim","Agus Riyanto","Subarjo","Marzuki","Syahrudin",
"Muhammad Rafai","Dahri Ansori","Abdu Samad","Oktarian Priyatno",
"Andriansyah","Randi Febriadi","Sarno Budi Santoso","Sigit Santoso"
];

let schedule = [];
let indexPegawai = 0;

function generateSchedule(){
    const start = new Date("2026-01-01");
    const end = new Date("2026-12-31");

    for(let d = new Date(start); d <= end; d.setDate(d.getDate()+1)){
        if(d.getDay() === 0 || d.getDay() === 6) continue;

        let petugas = [];
        for(let i=0;i<5;i++){
            petugas.push(pegawai[indexPegawai % pegawai.length]);
            indexPegawai++;
        }

        schedule.push({
            tanggal: d.toISOString().split("T")[0],
            hariNama: d.toLocaleDateString("id-ID",{weekday:"long"}),
            petugas
        });
    }
}
generateSchedule();

const today = new Date().toISOString().split("T")[0];
const dataHariIni = schedule.find(s => s.tanggal === today);

document.getElementById("tanggal").textContent =
new Date().toLocaleDateString("id-ID",{weekday:"long", year:"numeric", month:"long", day:"numeric"});

const list = document.getElementById("petugas");

if(dataHariIni){
    dataHariIni.petugas.forEach(nama=>{
        const li = document.createElement("li");
        li.textContent = nama;
        list.appendChild(li);
    });
}else{
    list.innerHTML = "<li>Tidak ada jadwal hari ini</li>";
}

function downloadExcel(){
    const now = new Date();
    const bulan = now.getMonth();
    const tahun = now.getFullYear();

    const dataBulanIni = schedule.filter(s=>{
        const d = new Date(s.tanggal);
        return d.getMonth() === bulan && d.getFullYear() === tahun;
    });

    const namaBulan = now.toLocaleDateString("id-ID",{month:"long"});

    const header = [["Tanggal","Hari","Petugas 1","Petugas 2","Petugas 3","Petugas 4","Petugas 5"]];
    const data = dataBulanIni.map(s=>[
        s.tanggal,s.hariNama,...s.petugas
    ]);

    const ws = XLSX.utils.aoa_to_sheet(header.concat(data));
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Jadwal");
    XLSX.writeFile(wb, `Rekap_Piket_${namaBulan}_${tahun}.xlsx`);
}
</script>

</body>
</html>
